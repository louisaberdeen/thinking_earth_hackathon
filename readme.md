## Installation

```bash
uv pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128
uv pip install -r requirements.txt
```
## Inspiration
Wildfires represent one of the most pressing environmental and economic challenges of our time, with annual damages in the United States alone reaching between $394 billion and $893 billion - [United States Joint Economic Committee](https://www.jec.senate.gov/public/index.cfm/democrats/2023/10/climate-exacerbated-wildfires-cost-the-u-s-between-394-to-893-billion-each-year-in-economic-costs-and-damages). Scientists have warned that wildfires are becoming more frequent and more widespread - [ESA](https://www.esa.int/Applications/Observing_the_Earth/Copernicus/Sentinel-3/Counting_wildfires_across_the_globe), driven by climate change and land-use patterns. Looking ahead, there are projections that extreme fires will increase globally by up to 14 percent by 2030, 30 percent by 2050, and 50 percent by the end of the century - [UN Environment Programme](https://www.unep.org/news-and-stories/press-release/number-wildfires-rise-50-cent-2100-and-governments-are-not-prepared), making wildfire preparedness and understanding increasingly critical for communities worldwide. Because of this, the company I work for has identified this a key vulnerability that governments are not doing enough to prepare for the exponential growth of extreme fire events. Tackling such a chaotic and dangerous natural disaster requires using every little bit of data and technology to get an advantage. Earth observation data is a clearly well suited to the task given the large amount of area that we need to survey. However, the problem is very ill-posed, that is to say there is no objective measure by which to train or evaluate a model against. We could try to take a frequentist approach where we track all past wildfires using MODIS and assign any area with a wildfire in the preceding 3 months as high risk, the problem with this approach is we don't have *any* idea what effect risk has on the likelihood of a wildfire breaking out, we know it's not 0 and it's not 100, this is exacerbated by the fact that many wildfires can be started by humans.  Traditional methods like [Rothermel](https://www.research.ed.ac.uk/en/publications/rothermels-model-and-the-role-of-fuel-bed-structure)  build a model for wildfire spread by combining a mathematical model with empirical measurements in controlled environments. Their research shows there are several key factors that affect the Rate of spread including: fuel load, moisture, slope angle, and wind (among others) . The Fosberg Fire Weather Index (FFWI) uses the Rothermel model to rate each location by "if a wildfire were to start here, how fast would it spread", this is a very clever approach that gives us a baseline to compare between areas. However, the computation of this spread rate requires knowing many different atmospheric and terrain measurements that require many different instruments which all need to be calibrated, additionally the spread rate only considers the local conditions effecting the rate of spread but would like to consider features across many scales (how would a canyon/cliff effect the risk of spread for example). I think EO foundation models are a great fit to this problem as they enable the fusion many scales and types of remote sensing data like hyperspectral and DEM.

## What it does
What I attempted to do was take a wildfire risk dataset [FireRisk](https://arxiv.org/abs/2303.07035) where they match RGB NAIP imagery to 7 risk levels:  High, Low, Moderate, Non-burnable, Very High, Very Low, Water which they take from Wildfire Hazard Potential (WHP) raster dataset. They trained ResNet and Masked Auto Encoders models achieving accuracy and f1 scores of 63.20 52.56 and 65.29 55.49. My aim was to take initially DOFA and train a model to achieve similar benchmark scores before moving on to attempt either integrating DEM and atmospheric parameters via CopernicusFM.

## How we built it
I started by trying to use the notebooks provided but found that when using the data loaders I wasn't able to utilise multiple parallel workers to achieve full utilisation of my GPU. I used Claude to rewrite the datamodule so that the transforms and readers were multithread compatible which worked really well. I then downloaded the dataset from torchgeo and the model weights for DOFA from huggingface and wrapped everything with lighting to make training (and retraining) simple and parametrised which helped with iterating on the solution.
## Challenges we ran into
The main issue I had was with optimising the model to achieve baseline performance. I after writing and testing my code I set my first training run to go for 100 epochs like they did in the paper. When I went to validate my model the performance was shocking. Achieving an f1 score of 20! and an accuracy of 60. I checked my pre-processing steps step by step, I modified my learning rate adapter to be more cautious, I added batch normalisation, I added gradient clipping, and I added label smoothing. This did help with training smoothness and convergence however by the end I had ran out of time.
## Accomplishments that we're proud of
Giving it a go and taking the time to research into such an interesting topic. Everything I have learned will go into my work going forwards where I would like to keep researching and building with foundational earth observation models.
## What we learned
While new models are very exciting and open a lot of really powerful options, the difficulties with training models never really changes.
## What's next for Fire FM
